============================================ test session starts ============================================
platform darwin -- Python 3.13.2, pytest-8.3.5, pluggy-1.5.0
rootdir: /Users/celine/Research/librarybench
configfile: pyproject.toml
plugins: anyio-4.9.0, json-report-1.5.0, metadata-3.1.1
collected 17 items

tests/test_cache.py .                                                                                 [  5%]
tests/test_cli.py ..F..F.                                                                             [ 47%]
tests/test_manager.py .F....                                                                          [ 82%]
tests/test_repo.py F..                                                                                [100%]

================================================= FAILURES ==================================================
_____________________________________________ test_cli_explain ______________________________________________

runner = <click.testing.CliRunner object at 0x10442cb90>

    def test_cli_explain(runner):
        runner.invoke(cli, ['env','create','baz'])
        runner.invoke(cli, ['install','--env','baz','A'])
        r = runner.invoke(cli, ['explain','--env','baz','A'])
>       assert 'A==' in r.stdout
E       AssertionError: assert 'A==' in ''
E        +  where '' = <Result KeyError('B')>.stdout

tests/test_cli.py:33: AssertionError
______________________________________________ test_cli_repos _______________________________________________

runner = <click.testing.CliRunner object at 0x104409c70>
tmp_path = PosixPath('/private/var/folders/y3/jvd7wbrj6z7b2s97x7yyp_jc0000gn/T/pytest-of-celine/pytest-108/test_cli_repos0')

    def test_cli_repos(runner, tmp_path):
        # create a fake repo
        data = {"Z":{"0.1": []}}
        repof = tmp_path/"r.json"
        repof.write_text(json.dumps(data))
        r1 = runner.invoke(cli, ['repos','add',str(repof)])
        assert "Added repo" in r1.stdout
        r2 = runner.invoke(cli, ['repos','list'])
>       assert str(repof) in r2.stdout
E       AssertionError: assert '/private/var/folders/y3/jvd7wbrj6z7b2s97x7yyp_jc0000gn/T/pytest-of-celine/pytest-108/test_cli_repos0/r.json' in '/Users/celine/Research/librarybench/dependency_resolver_Student_o4-mini_iterative/src/env_manager/default_repo.json\n'
E        +  where '/private/var/folders/y3/jvd7wbrj6z7b2s97x7yyp_jc0000gn/T/pytest-of-celine/pytest-108/test_cli_repos0/r.json' = str(PosixPath('/private/var/folders/y3/jvd7wbrj6z7b2s97x7yyp_jc0000gn/T/pytest-of-celine/pytest-108/test_cli_repos0/r.json'))
E        +  and   '/Users/celine/Research/librarybench/dependency_resolver_Student_o4-mini_iterative/src/env_manager/default_repo.json\n' = <Result okay>.stdout

tests/test_cli.py:61: AssertionError
________________________________________ test_install_and_existence _________________________________________

mgr = <env_manager.manager.EnvManager object at 0x104456950>

    def test_install_and_existence(mgr):
        mgr.create_env("e1")
        mgr.install_packages("e1", ["A"])
        # A, B, C should be installed
        for pkg in ["A","B","C"]:
>           assert mgr.package_exists("e1", pkg)
E           AssertionError: assert False
E            +  where False = package_exists('e1', 'B')
E            +    where package_exists = <env_manager.manager.EnvManager object at 0x104456950>.package_exists

tests/test_manager.py:29: AssertionError
______________________________________ test_default_repo_contains_ABC _______________________________________

    def test_default_repo_contains_ABC():
        rm = RepositoryManager()
        # default repo has A, B, C
>       assert "A" in rm.list_repos()[0]  # path ends with default_repo.json
E       AssertionError: assert 'A' in '/Users/celine/Research/librarybench/dependency_resolver_Student_o4-mini_iterative/src/env_manager/default_repo.json'

tests/test_repo.py:20: AssertionError
------------------------------------------------ JSON report ------------------------------------------------
report saved to: report.json
========================================== short test summary info ==========================================
FAILED tests/test_cli.py::test_cli_explain - AssertionError: assert 'A==' in ''
FAILED tests/test_cli.py::test_cli_repos - AssertionError: assert '/private/var/folders/y3/jvd7wbrj6z7b2s9...
FAILED tests/test_manager.py::test_install_and_existence - AssertionError: assert False
FAILED tests/test_repo.py::test_default_repo_contains_ABC - AssertionError: assert 'A' in '/Users/celine/R...
======================================= 4 failed, 13 passed in 0.06s ========================================
