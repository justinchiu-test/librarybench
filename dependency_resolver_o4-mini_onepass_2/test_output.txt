============================================== test session starts ==============================================
platform darwin -- Python 3.13.2, pytest-8.3.5, pluggy-1.5.0
rootdir: /Users/celine/Research/librarybench
configfile: pyproject.toml
plugins: anyio-4.9.0, json-report-1.5.0, metadata-3.1.1
collected 17 items

tests.py ..............F..                                                                                [100%]

=================================================== FAILURES ====================================================
___________________________________ TestPackageManagerV2.test_version_support ___________________________________

self = <tests.TestPackageManagerV2 testMethod=test_version_support>

    def test_version_support(self):
        """Test that packages can be installed with specific versions"""
        self.pm.install_package("A", "1.0", [])
>       self.pm.install_package("A", "2.0", [])

tests.py:117: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
package_manager.py:119: in install_package
    self.install(spec)
package_manager.py:128: in install
    self._resolve(spec, parent=None, env=env)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <package_manager.PackageManager object at 0x1070ee4e0>, spec = 'A==2.0', parent = None
env = <package_manager.EnvData object at 0x106eced50>

    def _resolve(self, spec, parent, env):
        name, constraints = self._parse_spec(spec)
        # Choose version
        chosen = self._choose_version(name, constraints)
        # Check existing
        if name in env.installed_v2:
            if env.installed_v2[name] != chosen:
>               raise VersionConflictError(
                    f"Conflict on {name}: {env.installed_v2[name]} vs {chosen}"
                )
E               package_manager.VersionConflictError: Conflict on A: 1.0 vs 2.0

package_manager.py:137: VersionConflictError
-------------------------------------------------- JSON report --------------------------------------------------
report saved to: report.json
============================================ short test summary info ============================================
FAILED tests.py::TestPackageManagerV2::test_version_support - package_manager.VersionConflictError: Conflict o...
========================================= 1 failed, 16 passed in 0.08s ==========================================
