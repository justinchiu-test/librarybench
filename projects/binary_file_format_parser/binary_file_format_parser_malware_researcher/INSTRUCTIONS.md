# PyBinParser - Malware Analysis Binary Parser

## Overview
A specialized binary file format parser designed for cybersecurity researchers analyzing malicious software. This tool provides deep inspection capabilities for dissecting executable formats, identifying obfuscated data structures, and understanding how malware conceals its functionality within binary files.

## Persona Description
A cybersecurity researcher who analyzes malicious software by dissecting executable formats and obfuscated data structures. They need deep inspection capabilities to understand how malware hides its functionality within binary formats.

## Key Requirements
1. **Entropy Analysis Visualization**: Calculate and visualize entropy across binary sections to identify encrypted, compressed, or obfuscated regions that may contain hidden malware payloads. This is critical for detecting packed executables and encrypted configuration data.

2. **Cross-Reference Tracking**: Maintain bidirectional mappings between binary file offsets and disassembled code locations, enabling researchers to correlate suspicious binary patterns with their corresponding assembly instructions during reverse engineering workflows.

3. **Heuristic Pattern Matching**: Implement pattern recognition for common obfuscation techniques including XOR encryption, base64 encoding, custom packers, and anti-analysis tricks. The system should learn from known malware samples to improve detection accuracy.

4. **Export Hooks for IDA Pro and Ghidra**: Provide seamless integration with industry-standard reverse engineering tools through plugin interfaces, allowing researchers to import parsed structures directly into their existing analysis workflows.

5. **Timeline Reconstruction**: Extract and correlate timestamp fields from various binary structures (PE headers, embedded resources, metadata) to reconstruct the malware's development timeline and identify potential attribution indicators.

## Technical Requirements
- **Testability**: All parsing, analysis, and export functions must be fully testable via pytest without requiring actual malware samples
- **Performance**: Must handle large executable files (100MB+) with sub-second parsing times for initial structure analysis
- **Integration**: Plugin architecture supporting IDA Pro (via IDAPython) and Ghidra (via Python API) without requiring the tools to be installed for testing
- **Security**: Safe parsing that prevents malicious input from affecting the analysis system
- **No UI Components**: Pure Python library implementation with programmatic APIs only

## Core Functionality
The parser must provide:
- Binary structure parsing for common executable formats (PE, ELF, Mach-O)
- Entropy calculation with configurable window sizes
- Pattern matching engine with extensible rule definitions
- Offset mapping system for cross-referencing
- Timeline extraction from multiple timestamp sources
- Export formatters for various reverse engineering tools
- Safe handling of malformed or intentionally corrupted binaries

## Testing Requirements
Comprehensive test coverage must include:
- **Entropy Analysis**: Verify correct entropy calculations for known data patterns (random, compressed, encrypted)
- **Pattern Detection**: Test recognition of obfuscation techniques using synthetic test cases
- **Cross-Reference Accuracy**: Validate offset mappings with known binary structures
- **Export Format Compliance**: Ensure exported data matches tool-specific format requirements
- **Timeline Extraction**: Test timestamp parsing from various binary format headers
- **Edge Cases**: Handle truncated files, circular references, and malformed structures
- **Performance Benchmarks**: Verify parsing speed meets requirements for large files
- **Security Testing**: Ensure malicious inputs cannot compromise the parser

All tests must be executable via:
```
pip install pytest-json-report
pytest --json-report --json-report-file=pytest_results.json
```

## Success Criteria
The implementation is successful when:
- All pytest tests pass with 100% success rate
- A valid pytest_results.json file is generated showing all tests passing
- Entropy analysis correctly identifies obfuscated sections in test binaries
- Pattern matching detects all implemented obfuscation techniques
- Cross-reference mappings are accurate for all supported binary formats
- Export hooks produce valid output for IDA Pro and Ghidra formats
- Timeline reconstruction accurately extracts all available timestamps
- Performance benchmarks meet or exceed requirements
- The library safely handles malformed inputs without crashes

## Environment Setup
To set up the development environment:
```
uv venv
source .venv/bin/activate
uv pip install -e .
```