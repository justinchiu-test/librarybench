================================================================ test session starts =================================================================
platform darwin -- Python 3.13.2, pytest-8.3.5, pluggy-1.5.0
rootdir: /Users/celine/Research/librarybench
configfile: pyproject.toml
plugins: anyio-4.9.0, json-report-1.5.0, timeout-2.4.0, metadata-3.1.1
timeout: 60.0s
timeout method: signal
timeout func_only: False
collected 15 items

test_schema_import_export.py ..                                                                                                                [ 13%]
test_plugins.py .                                                                                                                              [ 20%]
test_validator_core.py .......                                                                                                                 [ 66%]
test_async_validation.py EEEE                                                                                                                  [ 93%]
test_schema_usage_integration.py .                                                                                                             [100%]

======================================================================= ERRORS =======================================================================
_______________________________________________ ERROR at setup of test_async_validation_pass[asyncio] ________________________________________________
file /Users/celine/Research/librarybench/datavalidator_o4-mini_0/data_engineer/test_async_validation.py, line 14
  @pytest.mark.anyio
  async def test_async_validation_pass(schema_def_async):
      ext = DummyExternal(bad_values=['bad'])
      val = Validator(schema_def_async, external_validator=ext)
      rec = {'customer_id': 'good', 'order_id': '100'}
      result = await val.validate_async(rec)
      assert result.success
E       fixture 'schema_def_async' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, doctest_namespace, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, include_metadata_in_junit_xml, json_metadata, metadata, monkeypatch, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/celine/Research/librarybench/datavalidator_o4-mini_0/data_engineer/test_async_validation.py:14
_______________________________________________ ERROR at setup of test_async_validation_fail[asyncio] ________________________________________________
file /Users/celine/Research/librarybench/datavalidator_o4-mini_0/data_engineer/test_async_validation.py, line 22
  @pytest.mark.anyio
  async def test_async_validation_fail(schema_def_async):
      ext = DummyExternal(bad_values=['bad'])
      val = Validator(schema_def_async, external_validator=ext)
      rec = {'customer_id': 'bad', 'order_id': '100'}
      result = await val.validate_async(rec)
      assert not result.success
      assert any(e['code'] == 'EXTERNAL' for e in result.errors)
E       fixture 'schema_def_async' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, doctest_namespace, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, include_metadata_in_junit_xml, json_metadata, metadata, monkeypatch, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/celine/Research/librarybench/datavalidator_o4-mini_0/data_engineer/test_async_validation.py:22
_________________________________________________ ERROR at setup of test_async_validation_pass[trio] _________________________________________________
file /Users/celine/Research/librarybench/datavalidator_o4-mini_0/data_engineer/test_async_validation.py, line 14
  @pytest.mark.anyio
  async def test_async_validation_pass(schema_def_async):
      ext = DummyExternal(bad_values=['bad'])
      val = Validator(schema_def_async, external_validator=ext)
      rec = {'customer_id': 'good', 'order_id': '100'}
      result = await val.validate_async(rec)
      assert result.success
E       fixture 'schema_def_async' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, doctest_namespace, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, include_metadata_in_junit_xml, json_metadata, metadata, monkeypatch, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/celine/Research/librarybench/datavalidator_o4-mini_0/data_engineer/test_async_validation.py:14
_________________________________________________ ERROR at setup of test_async_validation_fail[trio] _________________________________________________
file /Users/celine/Research/librarybench/datavalidator_o4-mini_0/data_engineer/test_async_validation.py, line 22
  @pytest.mark.anyio
  async def test_async_validation_fail(schema_def_async):
      ext = DummyExternal(bad_values=['bad'])
      val = Validator(schema_def_async, external_validator=ext)
      rec = {'customer_id': 'bad', 'order_id': '100'}
      result = await val.validate_async(rec)
      assert not result.success
      assert any(e['code'] == 'EXTERNAL' for e in result.errors)
E       fixture 'schema_def_async' not found
>       available fixtures: anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, doctest_namespace, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, include_metadata_in_junit_xml, json_metadata, metadata, monkeypatch, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/celine/Research/librarybench/datavalidator_o4-mini_0/data_engineer/test_async_validation.py:22
================================================================== warnings summary ==================================================================
datavalidator_o4-mini_0/data_engineer/test_plugins.py::test_plugin_transform_affects_validation
  /Users/celine/Research/librarybench/datavalidator_o4-mini_0/data_engineer/etl_validator/validator.py:25: DeprecationWarning: There is no current event loop
    loop = asyncio.get_event_loop()

datavalidator_o4-mini_0/data_engineer/test_validator_core.py::test_missing_required
datavalidator_o4-mini_0/data_engineer/test_validator_core.py::test_enum_violation
datavalidator_o4-mini_0/data_engineer/test_validator_core.py::test_conditional_validation
datavalidator_o4-mini_0/data_engineer/test_validator_core.py::test_conditional_validation
datavalidator_o4-mini_0/data_engineer/test_validator_core.py::test_default_values
datavalidator_o4-mini_0/data_engineer/test_validator_core.py::test_range_checks
datavalidator_o4-mini_0/data_engineer/test_validator_core.py::test_optional_fields_flagged
  /Users/celine/Research/librarybench/datavalidator_o4-mini_0/data_engineer/etl_validator/validator.py:49: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    rec[fname] = datetime.utcnow().isoformat()

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
-------------------------------------------------------------------- JSON report ---------------------------------------------------------------------
report saved to: report.json
============================================================== short test summary info ===============================================================
ERROR test_async_validation.py::test_async_validation_pass[asyncio]
ERROR test_async_validation.py::test_async_validation_fail[asyncio]
ERROR test_async_validation.py::test_async_validation_pass[trio]
ERROR test_async_validation.py::test_async_validation_fail[trio]
====================================================== 11 passed, 8 warnings, 4 errors in 0.07s ======================================================
