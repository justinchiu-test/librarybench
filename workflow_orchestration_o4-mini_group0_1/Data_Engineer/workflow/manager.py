# no changes needed; core logic remains the same
