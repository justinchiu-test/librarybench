======================================== test session starts ========================================
platform darwin -- Python 3.13.2, pytest-8.3.5, pluggy-1.5.0
rootdir: /Users/celine/Research/librarybench
configfile: pyproject.toml
plugins: anyio-4.9.0, json-report-1.5.0, metadata-3.1.1
collected 31 items / 4 errors

Research_Scientist/test_scheduler.py F                                                        [  3%]
Research_Scientist/test_dynamic.py F                                                          [  6%]
Research_Scientist/test_models.py ...                                                         [ 16%]
Research_Scientist/test_manager.py ...                                                        [ 25%]
Software_Developer/test_task.py ....                                                          [ 38%]
Software_Developer/test_backoff.py ..                                                         [ 45%]
Software_Developer/test_scheduler.py F                                                        [ 48%]
Software_Developer/test_queue.py ..                                                           [ 54%]
DevOpsEngineer/test_retry.py ....                                                             [ 67%]
DevOpsEngineer/test_core.py ...                                                               [ 77%]
DevOpsEngineer/test_alerting.py .                                                             [ 80%]
DevOpsEngineer/test_integration.py .                                                          [ 83%]
DevOpsEngineer/test_manager.py .....                                                          [100%]

============================================== ERRORS ===============================================
_____ ERROR collecting workflow_orchestration_o4-mini_group2_0/Research_Scientist/test_auth.py ______
ImportError while importing test module '/Users/celine/Research/librarybench/workflow_orchestration_o4-mini_group2_0/Research_Scientist/test_auth.py'.
Hint: make sure your test modules/packages have valid Python names.
Traceback:
../../../miniconda3/envs/library/lib/python3.13/importlib/__init__.py:88: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
Research_Scientist/test_auth.py:2: in <module>
    from Research_Scientist.workflow.auth import AuthManager, AuthError, requires_auth
Research_Scientist/workflow/auth.py:2: in <module>
    from .auth import AuthError
E   ImportError: cannot import name 'AuthError' from partially initialized module 'Research_Scientist.workflow.auth' (most likely due to a circular import) (/Users/celine/Research/librarybench/workflow_orchestration_o4-mini_group2_0/Research_Scientist/workflow/auth.py)
______ ERROR collecting workflow_orchestration_o4-mini_group2_0/Research_Scientist/test_cli.py ______
ImportError while importing test module '/Users/celine/Research/librarybench/workflow_orchestration_o4-mini_group2_0/Research_Scientist/test_cli.py'.
Hint: make sure your test modules/packages have valid Python names.
Traceback:
../../../miniconda3/envs/library/lib/python3.13/importlib/__init__.py:88: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
Research_Scientist/test_cli.py:2: in <module>
    from Research_Scientist.workflow.cli import CLI
Research_Scientist/workflow/cli.py:3: in <module>
    from .auth import AuthManager, requires_auth
Research_Scientist/workflow/auth.py:2: in <module>
    from .auth import AuthError
E   ImportError: cannot import name 'AuthError' from partially initialized module 'Research_Scientist.workflow.auth' (most likely due to a circular import) (/Users/celine/Research/librarybench/workflow_orchestration_o4-mini_group2_0/Research_Scientist/workflow/auth.py)
___ ERROR collecting workflow_orchestration_o4-mini_group2_0/Software_Developer/test_workflow.py ____
ImportError while importing test module '/Users/celine/Research/librarybench/workflow_orchestration_o4-mini_group2_0/Software_Developer/test_workflow.py'.
Hint: make sure your test modules/packages have valid Python names.
Traceback:
../../../miniconda3/envs/library/lib/python3.13/importlib/__init__.py:88: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
Software_Developer/test_workflow.py:3: in <module>
    from Software_Developer.task_manager.workflow import Workflow, WorkflowManager
E   ImportError: cannot import name 'WorkflowManager' from 'Software_Developer.task_manager.workflow' (/Users/celine/Research/librarybench/workflow_orchestration_o4-mini_group2_0/Software_Developer/task_manager/workflow.py)
______ ERROR collecting workflow_orchestration_o4-mini_group2_0/Software_Developer/test_api.py ______
ImportError while importing test module '/Users/celine/Research/librarybench/workflow_orchestration_o4-mini_group2_0/Software_Developer/test_api.py'.
Hint: make sure your test modules/packages have valid Python names.
Traceback:
../../../miniconda3/envs/library/lib/python3.13/importlib/__init__.py:88: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
Software_Developer/test_api.py:3: in <module>
    from Software_Developer.task_manager.api import app, workflow_manager, scheduler, task_queue
Software_Developer/task_manager/api.py:1: in <module>
    from fastapi import FastAPI, HTTPException
E   ModuleNotFoundError: No module named 'fastapi'
============================================= FAILURES ==============================================
___________________________________ test_scheduler_runs_due_tasks ___________________________________

monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x105e550f0>

    def test_scheduler_runs_due_tasks(monkeypatch):
        manager = TaskManager()
        # dummy task
        def f():
            return 'ok'
        task = Task(id='sched1', func=f, args=(), priority=1,
                    retry_policy=RetryPolicy())
        scheduler = Scheduler()
        # pretend time.time: start at 100
        fake_time = [100.0]
        def time_time():
            return fake_time[0]
        monkeypatch.setattr(time, 'time', time_time)
>       scheduler.schedule(manager, task, interval_seconds=10)
E       TypeError: Scheduler.schedule() got multiple values for argument 'interval_seconds'

Research_Scientist/test_scheduler.py:20: TypeError
____________________________________ test_dynamic_task_creation _____________________________________

monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x105e55810>

    def test_dynamic_task_creation(monkeypatch):
        manager = TaskManager()
        # Create a task that generates another task
        parent = Task(id='p1', func=dynamic_creator,
                      args=(manager, 'p1'), priority=2,
                      retry_policy=RetryPolicy())
        monkeypatch.setattr(__import__('time'), 'sleep', lambda x: None)
        manager.add_task(parent)
        manager.run_all()
        # parent should have succeeded
        p = manager.get_task('p1')
        assert p.state == TaskState.SUCCESS
        assert p.result == 'p1_parent'
        # child should exist and be pending, now run it
        c = manager.get_task('p1_child')
        assert c is not None
>       assert c.state == TaskState.PENDING
E       AssertionError: assert <TaskState.SUCCESS: 'success'> == <TaskState.PENDING: 'pending'>
E        +  where <TaskState.SUCCESS: 'success'> = Task(priority=1, id='p1_child', func=<function dynamic_creator.<locals>.new_task at 0x1063cd260>, args=(), kwargs={}, ...olicy(max_retries=0, retry_delay_seconds=0.0), state=<TaskState.SUCCESS: 'success'>, retries_done=0, result='p1_child').state
E        +  and   <TaskState.PENDING: 'pending'> = TaskState.PENDING

Research_Scientist/test_dynamic.py:30: AssertionError
______________________________________ test_schedule_interval _______________________________________

    def test_schedule_interval():
        s = Scheduler()
        ctr = {"n":0}
        s.schedule(0.2, lambda: ctr.__setitem__("n", ctr["n"]+1))
        time.sleep(0.7)
>       s.stop()
E       AttributeError: 'Scheduler' object has no attribute 'stop'

Software_Developer/test_scheduler.py:9: AttributeError
-------------------------------------------- JSON report --------------------------------------------
report saved to: report.json
====================================== short test summary info ======================================
FAILED Research_Scientist/test_scheduler.py::test_scheduler_runs_due_tasks - TypeError: Scheduler....
FAILED Research_Scientist/test_dynamic.py::test_dynamic_task_creation - AssertionError: assert <Ta...
FAILED Software_Developer/test_scheduler.py::test_schedule_interval - AttributeError: 'Scheduler' ...
ERROR Research_Scientist/test_auth.py
ERROR Research_Scientist/test_cli.py
ERROR Software_Developer/test_workflow.py
ERROR Software_Developer/test_api.py
============================== 3 failed, 28 passed, 4 errors in 4.02s ===============================
